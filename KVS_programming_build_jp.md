# 2.1 プログラムの作成と実行 #
ここでは、現在利用しているKVSのバージョン番号を表示するプログラムの作成をとおして、プログラムの「作成→コンパイル→実行」といった一連の流れについて説明します。

## 2.1.1 作成 ##
最初に、作業用フォルダを作成します。「lesson1」という名前のフォルダを作成し、そのフォルダ内に「main.cpp」という名前のファイルを作成してください。このとき、ファイルの拡張子は、必ず「cpp」としてください。

KVSのバージョン番号は、メジャーバージョン、マイナーバージョン、パッチバージョンの3つの番号からなります。通常、「メジャーバージョン.マイナーバージョン.パッチバージョン」というようにそれぞれ「.」で区切って表しています。それぞれの番号は、以下の3つのメソッドを利用して取得することで利用可能となります。

```
size_t major = kvs::Version::MajorVersion(); // メジャーバージョン番号の取得
size_t minor = kvs::Version::MinorVersion(); // マイナーバージョン番号の取得
size_t patch = kvs::Version::PatchVersion(); // パッチバージョン番号の取得
```

KVSに実装されているすべてのクラスおよびメソッドは、名前空間「kvs」内に定義されています。上記の例では、たとえば、「kvs::Version::MajorVersion()」は、「名前空間kvsに定義されているVersion::MajorVersionメソッド」を表しています。

これらのメソッドを利用するときには、適切にヘッダファイルをインクルードする必要があります。KVSでは、利用したいクラスに対して、「#include <kvs/クラス名>」または「#include <kvs/名前空間名>」という形式で記述します。

先の3つのメソッドに対しては、以下のようにしてヘッダファイルをインクルードします。

```
#include <kvs/Version>
```

これらのメソッドを利用してKVSのバージョン番号を表示するプログラムを以下に示します。エディタでmain.cppを開き、以下を記述した後、保存してください。

```
#include <kvs/Version>
#include <iostream>

int main()
{
    size_t major = kvs::Version::MajorVersion(); // メジャーバージョン番号の取得
    size_t minor = kvs::Version::MinorVersion(); // マイナーバージョン番号の取得
    size_t patch = kvs::Version::PatchVersion(); // パッチバージョン番号の取得

    // バージョン情報を表示する。
    std::cout << "KVS " << major << "." << minor << "." << patch << std::endl;

    return 0;
}
```

## 2.1.2 コンパイル ##
作成したプログラムをコンパイルします。ターミナルを開き、プログラムを作成したlesson1フォルダに移動してください。

```
> cd lesson1
```

一般的に、作成したプログラムをコンパイルするときには、必要なライブラリのリンクやパスなどを適切に設定する必要があります。また、コンパイラによってその方法は異なります。KVSを利用して作成したプログラムをコンパイルするときにも、そのような設定が必要となりますが、KVSではkvsmakeコマンドを利用してコンパイルすることで、それらの手間を軽減しています。

まず、kvsmakeコマンドを利用してMakefileを作成します。kvsmakeコマンドに「-G」オプションを付けて実行します。「-G」オプションを付けることで、コンパイル後にカレントフォルダと同名の実行ファイルが生成されます。ここでは、lesson1という名前の実行ファイルが生成されます。

```
> kvsmake -G
```

上記コマンドを実行すると、Windows環境では「Makefile.vc.kvs」が、Linux / Mac環境では「Makefile.kvs」が生成されます。以下のように、kvsmakeコマンドを引数なしで実行することで、Makefile内に記述された情報をもとにコンパイルすることができます。

```
> kvsmake
```

実行ファイル名を独自に指定する場合は、「-G」オプションではなく「-g」オプションを利用します。以下の例では、「sample」という実行ファイル名を指定し、コンパイルしています。

```
> kvsmake -g sample
> kvsmake
```

## 2.1.3 実行 ##
コンパイルが正常に終了すると、カレントフォルダに「lesson1」という実行ファイルが生成されます。Windows環境では、「lesson1.exe」という実行ファイル名となります。

Windows環境の場合、以下のようにして実行します。

```
> lesson1.exe
```

Linux/Mac環境の場合、以下のようにして実行します。

```
> ./lesson1
```

実行結果は、たとえば、利用しているKVSのバージョンが1.0.0の場合、以下のようになります。

```
KVS 1.0.0
```